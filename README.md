# 基于人脸识别的考勤系统
## 项目介绍 📖
基于Qt和OpenCV开发的人脸识别考勤系统，实现员工快速注册与自动考勤打卡功能。

## 项目背景 💡
传统考勤方式（如指纹打卡、卡片打卡）存在代打卡、设备易损坏等问题。本项目通过人脸识别技术，实现无人值守的智能考勤，提高考勤效率和准确性，适用于企业、学校等需要人员出勤管理的场景。

## 技术栈 🛠️
### 开发框架
1. Qt 5.15.2 + MinGW 64位 - 跨平台GUI开发框架
2. C++11 - 主要编程语言

### 技术支持
1. OpenCV 4.5.2 - 开源计算机视觉库，提供丰富的图像处理函数和实时视频处理能力
2. SeetaFace 2.0 - 轻量级人脸识别引擎，专为资源受限环境优化，提供高精度人脸检测和识别功能
3. SQLite - 嵌入式关系型数据库，无需独立服务器，适合本地数据存储和查询
4. TCP/IP网络通信 - 基于Qt的QTcpServer/QTcpSocket实现，确保客户端与服务器之间的数据可靠传输

### 核心版块
| 模块名称 | 主要功能 | 技术实现 | 详细说明 |
|---------|---------|--------|--------|
| 人脸检测 | 实时捕获并检测人脸位置 | OpenCV Haar级联分类器 | 采用haarcascade_frontalface_alt2.xml分类器，提供高效的人脸检测 |
| 人脸识别 | 提取人脸特征并进行身份匹配 | SeetaFace 2.0引擎 | 利用FD、PD、FR三个核心模块完成人脸检测、关键点定位和特征匹配 |
| 员工管理 | 注册、存储和管理员工信息 | SQLite数据库 | 提供员工基本信息的增删改查功能，关联人脸数据 |
| 考勤记录 | 记录和统计考勤数据 | TCP网络通信 + SQLite | 实时记录考勤时间，支持考勤数据查询和导出 |
| 网络通信 | 客户端与服务器数据交互 | Qt Network模块 | 实现图像数据传输、身份验证和考勤结果返回 |

### 项目架构
项目采用经典的C/S（客户端-服务器）架构设计：
- **服务器端（AttendanceServer）**：作为系统核心，负责员工信息管理、人脸识别算法处理、考勤数据存储和业务逻辑处理
- **客户端（FaceAttendance）**：作为用户交互界面，负责摄像头实时视频采集、人脸检测、考勤结果展示和用户操作响应
- **数据流向**：客户端采集人脸 → 发送至服务器 → 服务器识别并记录 → 返回结果给客户端
- **优势**：服务端集中处理计算密集型任务，客户端轻量化部署，提高系统整体性能和可维护性

### 项目文件结构
```
人脸识别考勤系统/
├── AttendanceServer/          # 服务器端
│   ├── build/                 # 构建输出目录
│   ├── AttendanceServer.pro   # Qt项目配置文件
│   ├── main.cpp               # 服务器程序入口
│   ├── attendancewin.cpp/h/ui # 考勤主窗口（管理界面）
│   ├── registerwin.cpp/h/ui   # 员工注册窗口
│   ├── seletwin.cpp/h/ui      # 功能选择窗口
│   └── qfaceobject.cpp/h      # 人脸识别核心对象
├── FaceAttendance/            # 客户端
│   ├── build/                 # 构建目录
│   ├── FaceAttendance.pro     # 项目文件
│   ├── main.cpp               # 主函数
│   ├── faceattendannce.cpp/h/ui # 人脸考勤主窗口
│   └── image.qrc              # 资源文件
├── README.md                  # 项目说明文档
└── README.assets/             # 文档资源图片目录
```

### 项目流程
#### 系统启动流程
1. 首先启动服务器端应用程序，初始化SQLite数据库连接
2. 服务器端自动创建员工表和考勤表（若不存在）
3. 服务器端启动TCP服务器，监听客户端连接请求
4. 启动客户端应用程序，自动尝试连接服务器
5. 客户端连接成功后，初始化摄像头并开始视频采集

#### 员工注册流程
1. 在服务器端打开员工注册界面
2. 填写员工基本信息（姓名、性别、生日、地址、电话等）
3. 拍摄或上传员工照片
4. 系统自动检测照片中的人脸并提取特征向量
5. 将员工信息和人脸特征存储到SQLite数据库

#### 考勤打卡流程
1. 员工面对客户端摄像头
2. 客户端实时检测人脸并截取人脸区域
3. 将人脸图像通过TCP/IP发送至服务器
4. 服务器使用SeetaFace 2.0引擎提取人脸特征
5. 与数据库中已注册的人脸特征进行比对匹配
6. 匹配成功后，记录考勤时间和员工ID到数据库
7. 将识别结果和考勤状态返回给客户端显示

## 项目功能 📋
1. 员工人脸注册 - 支持拍摄或上传员工照片，自动提取人脸特征向量，关联员工基本信息（姓名、性别、生日等）并存储到SQLite数据库
2. 实时人脸检测 - 客户端通过OpenCV实时捕获摄像头视频流，使用Haar级联分类器高效检测人脸位置和数量
3. 人脸识别考勤 - 检测到人脸后，自动截取人脸区域并通过TCP/IP通信发送至服务器，服务器利用SeetaFace 2.0引擎进行特征提取和匹配，完成身份识别
4. 自动考勤记录 - 身份识别成功后，系统自动记录考勤时间、员工ID等信息到数据库，并支持签到/签退状态管理
5. 员工信息管理 - 服务器端提供完整的员工信息管理界面，支持员工信息的添加、查询、修改、删除等操作，以及人脸数据的重新采集和更新

## 项目应用方向 🔮
### 未来趋势
1. 多模态生物识别融合，提高识别准确率和安全性
2. 移动终端支持，实现手机远程考勤和管理

### 行业方向
1. 企业考勤管理，提高人力资源管理效率
2. 校园考勤系统，加强学生出勤监管

## 使用说明 🚀
### 配置说明
1. OpenCV配置：确保`haarcascade_frontalface_alt2.xml`分类器文件路径正确
   ```
   cascade.load("C:/opencv452/etc/haarcascades/haarcascade_frontalface_alt2.xml");
   ```

2. SeetaFace配置：确保模型文件路径正确
   ```
   seeta::ModelSetting FDmode("C:/SeetaFace/bin/model/fd_2_00.dat",seeta::ModelSetting::CPU,0);
   seeta::ModelSetting PDmode("C:/SeetaFace/bin/model/pd_2_00_pts5.dat",seeta::ModelSetting::CPU,0);
   seeta::ModelSetting FRmode("C:/SeetaFace/bin/model/fr_2_10.dat",seeta::ModelSetting::CPU,0);
   ```

3. 数据库配置：系统自动创建SQLite数据库`server.db`，存储员工信息

## 注意事项 ⚠️
- 确保摄像头连接正常且光线充足，避免逆光和暗光环境
- 首次运行需要正确配置OpenCV和SeetaFace的模型文件路径
- 网络连接不稳定时，系统具备自动重连机制，但建议在稳定网络环境下使用

## 编写项目时遇到的问题及解决方法 🛠️
### 问题一：上传照片进行测试时，ID 始终为 -1，如何处理？
**答：**
1. 检查图片路径是否包含中文或特殊字符。
2. 确认上传的照片为清晰的人脸图片。

### 问题二：程序操作数据库时总是报错，怎么办？
**答：**
先检查 SQL 语句是否正确；若修正后仍报错，可能是之前创建的数据库结构有误，导致新数据无法写入。建议删除旧数据库并重新生成。

### 问题三：修改 UI 界面后未生效，如何解决？
**答：**
删除目录中所有以 `ui_` 开头的相关生成文件，重新构建并编译运行程序即可。

### 问题四：如何看待OpenCV和seetaface的关系和联系？
**答：**
OpenCV 
- 主要负责 底层图像处理 和 视频捕获 功能
- 提供 cv::Mat 数据结构作为图像的基本表示形式
- 在客户端负责通过摄像头捕获视频帧和初步人脸检测
- 处理图像的读取、转换和存储等基础操作
SeetaFace
- 是一个专业的人脸识别引擎 ，专注于高精度人脸识别任务
- 包含三个核心功能模块：
  - FD (Face Detection)：人脸检测模块
  - PD (Point Detection)：关键点定位模块（定位5个关键点）
  - FR (Face Recognition)：人脸识别模块
- 提供人脸注册、查询和数据库管理的完整解决方案
交互关系：
- OpenCV负责获取和处理原始图像数据，以 cv::Mat 格式存储
- 在进行人脸识别前，需要将OpenCV的 cv::Mat 数据结构转换为SeetaFace的 SeetaImageData 格式
- SeetaFace引擎处理转换后的图像数据，进行人脸检测、关键点定位和人脸识别
- 识别结果返回给客户端，客户端根据结果更新考勤记录
总结：OpenCV提供强大的通用图像处理能力，SeetaFace提供专业高效的人脸识别算法，两者结合实现了一个完整的人脸识别考勤系统。



   ![444](README.assets/444.png)

![555](README.assets/555.png)

![666](README.assets/666.png)

![777](README.assets/777.png)

